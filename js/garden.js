System.register(["./vector"],function(t,o){"use strict";function i(t,o,i){var e=n(Math.round(r(t,o)),Math.round(r(t,o)),Math.round(r(t,o)),i);return e}function n(t,o,i,n){var e="rgba("+t+", "+o+", "+i+", "+n+")";return e}function e(t){return c/360*t}function r(t,o){return Math.random()*(o-t)+t}function s(t,o){return Math.floor(Math.random()*(o-t+1))+t}var a,c,h,l,u,m;o&&o.id;return{setters:[function(t){a=t}],execute:function(){c=2*Math.PI,h=function(){function t(t,o,i,n,e,r){this.stretchA=t,this.stretchB=o,this.startAngle=i,this.angle=n,this.bloom=r,this.growFactor=e,this.radius=1,this.isFinished=!1}return t.prototype.draw=function(){var t,o,i,n,r=this.bloom.garden.ctx;t=new a.Vector(0,this.radius).rotate(e(this.startAngle)),o=t.clone().rotate(e(this.angle)),i=t.clone().multiply(this.stretchA),n=o.clone().multiply(this.stretchB),r.strokeStyle=this.bloom.colour,r.beginPath(),r.moveTo(t.x,t.y),r.bezierCurveTo(i.x,i.y,n.x,n.y,o.x,o.y),r.stroke()},t.prototype.render=function(){this.radius<=this.bloom.radius?(this.radius+=this.growFactor,this.draw()):this.isFinished=!0},t}(),t("Petal",h),l=function(){function t(t,o,i,n,e){this.centre=t,this.radius=o,this.colour=i,this.garden=e,this.petals=[],this.addPetals(n),this.garden.addBloom(this),this.isStarted=!1}return t.prototype.addPetals=function(t){for(var o,i=360/t,n=s(0,90),e=0;e<t;e++)o=new h(r(u.options.petalStretch.min,u.options.petalStretch.max),r(u.options.petalStretch.min,u.options.petalStretch.max),n+e*i,i,r(u.options.growFactor.min,u.options.growFactor.max),this),this.petals.push(o)},t.prototype.draw=function(){var t=!0;this.garden.ctx.save(),this.garden.ctx.translate(this.centre.x,this.centre.y),this.petals.forEach(function(o){o.render(),t=t&&o.isFinished}),this.garden.ctx.restore(),t&&this.garden.removeBloom(this)},t}(),u=function(){function t(t,o){this.blooms=[],this.element=o,this.ctx=t}return t.prototype.render=function(){this.blooms.filter(function(t){return t.isStarted}).forEach(function(t){t.draw()})},t.prototype.addBloom=function(t){this.blooms.push(t)},t.prototype.startBlooms=function(o){var i;this.blooms.filter(function(n){return!n.isStarted&&(i=Math.sqrt(m(n.centre.x-o.x)+m(n.centre.y-o.y)),i<t.options.bloomStartDistance)}).forEach(function(t){t.isStarted=!0})},t.prototype.startAllBlooms=function(){this.blooms.forEach(function(t){t.isStarted=!0})},t.prototype.removeBloom=function(t){for(var o,i=0;i<this.blooms.length;i++)if(o=this.blooms[i],o===t){this.blooms.splice(i,1);break}return this},t.prototype.createRandomBloom=function(o,n){var e=this.bloomRadiusRange;this.createBloom(o,n,s(e.min,e.max),i(t.options.color.min,t.options.color.max,t.options.color.opacity),s(t.options.petalCount.min,t.options.petalCount.max))},t.prototype.createBloom=function(t,o,i,n,e){new l(new a.Vector(t,o),i,n,e,this)},t.prototype.clear=function(){this.blooms=[],this.ctx.clearRect(0,0,this.element.width,this.element.height)},Object.defineProperty(t.prototype,"bloomRadiusRange",{get:function(){return{min:this.scaleWindowSizeByFactor(t.BLOOM_RADIUS_RANGE_FACTORS.min),max:this.scaleWindowSizeByFactor(t.BLOOM_RADIUS_RANGE_FACTORS.max)}},enumerable:!0,configurable:!0}),t.prototype.scaleWindowSizeByFactor=function(t){var o=(window.innerWidth+window.innerHeight)/2;return Math.round(o/t)},t.BLOOM_RADIUS_RANGE_FACTORS={min:240,max:75},t.options={petalCount:{min:5,max:15},petalStretch:{min:.1,max:3},growFactor:{min:.1,max:1},bloomStartDistance:20,color:{min:0,max:255,opacity:.5}},t}(),t("Garden",u),m=function(t){return Math.pow(t,2)}}}});